601
## [#连续整除](#连续整除)**连续整除**

对于任意正整数n，我们定义函数streak(n)=k为使n+k不能被k+1整除的最小正整数k。
例如：
13能被1整除
14能被2整除
15能被3整除
16能被4整除
17不能被5整除
因此streak(13)=4。
类似地：
120能被1整除
121不能被2整除
因此streak(120)=1。

定义P(s,N)为1<n<N中满足streak(n)=s的整数n的数量。
因此P(3,14)=1，而P(6,106)=14286。

令i取值从1到31，求对应的P(i,4i)之和。
602
## [#抛硬币结果的乘积](#抛硬币结果的乘积)**抛硬币结果的乘积**

爱丽丝正在朋友的帮助下用一枚不公平硬币生成随机数。她和她的朋友围坐在桌子旁，从爱丽丝开始轮流抛掷硬币。每个人都各自记住他们抛出了多少次正面。当爱丽丝抛出正面时，这一流程宣告结束。此时，爱丽丝将她的朋友们所记录的正面次数相乘，作为她的随机数。

举例来说，假如爱丽丝找来鲍勃、查理和道恩帮忙，他们就按照这个顺序坐在桌子旁边，抛掷硬币的结果是序列THHH—TTTT—THHT—H，从爱丽丝开始并且到爱丽丝结束。鲍勃和查理各自抛出了2次正面，而道恩则抛出了1次正面。因此爱丽丝的随机数就是2×2×1=4。

记e(n,p)为帮忙的朋友数目为n（除爱丽丝自己以外）且硬币抛出反面概率为p时，爱丽丝所获得的随机数的期望值。

事实上，对于任意固定的n，e(n,p)总是p的一个多项式。例如e(3,p)=p3+4p2+p。

定义c(n,k)为多项式e(n,p)中pk项的系数。因此c(3,1)=1，c(3,2)=4，而c(3,3)=1。

已知c(100,40)≡986699437 (mod 109+7)。

求c(10000000,4000000)mod109+7。
603
## [#素数拼接的子串和](#素数拼接的子串和)**素数拼接的子串和**

记S(n)为整数n所能组成的全部连续整数子串的和。从不同位置和顺序得到的相同子串被视为不同的。

例如，S(2024)=2+0+2+4+20+02+24+202+024+2024=2304。

记P(n)为将前n个素数拼接成的整数。例如，P(7)=2357111317。

记C(n,k)为将k份P(n)拼接成的整数。例如，C(7,3)=235711131723571113172357111317。

试计算S(C(106,1012)) mod (109+7)。
604
---

## [#正方形中的凹路径](#正方形中的凹路径)**正方形中的凹路径**

记F(N)为，在一个和坐标系对齐的N×N正方形中，一个严格凹单调增函数所能够穿过的格点数目最大值。

已知F(1)=2，F(3)=3，F(9)=6，F(11)=7，F(100)=30以及F(50000)=1898。
以下是N=3时达成最大值的函数图象：
![p604_convex3.png](https://projecteuler.net/project/images/p604_convex3.png)
求F(1018)。


605

## [#配对抛掷硬币游戏](#配对抛掷硬币游戏)**配对抛掷硬币游戏**

考虑如下n名玩家轮流配对进行的游戏：第1轮在玩家1和2之间进行，第2轮在玩家2和3之间进行，依此类推，直到第n轮在玩家n和1之间进行。然后第n+1轮在玩家1和2之间进行，整个循环重新开始。

换言之，第r轮游戏中，玩家((r−1)modn)+1将会面对玩家(rmodn)+1。

在每一轮中，抛掷一枚公平硬币来决定哪一位玩家赢得本轮。如果有一名玩家同时在第r和r+1轮获胜，该玩家立即赢得整个游戏。

记Pn(k)为玩家k在一个n名玩家进行的游戏中获胜的概率。例如P3(1)=12/49，而P6(2)=368/1323。

记Mn(k)为Pn(k)表达为最简分数时分子和分母的乘积。例如，M3(1)=588，而M6(2)=486864。

求M108+7(104+7)的最后8位数字。

606
## [#因子链II](#因子链II)**因子链II**

n的因子链指的是一个序列{1,a,b,…,n}，其中每个元素都整除后一个元素。
例如，12有八条因子链：
{1,12}，{1,2,12}，{1,2,4,12}，{1,2,6,12}，{1,3,12}，{1,3,6,12}，{1,4,12}和{1,6,12}。

对于任意n，将所有不超过于n且恰好有252条不同因子链的整数k的和记为S(n)。
已知S(106)=8462952，而S(1012)=623291998881978。

求S(1036)，并给出其最后九位数字。

607
## [#穿越沼泽](#穿越沼泽)**穿越沼泽**

弗罗多和山姆需要从点A向东移动100里格（长度单位）到达点B。在普通的土地上，他们每天可以走10里格，所以这趟旅程将会花费10天时间。但是，他们在路上需要穿过一个从正西南向正东北延伸的长沼泽，而他们在沼泽中行进时需要降低速度。沼泽在任意一处的宽度都是50里格，而AB连线的中点也恰好落在沼泽的中点。下图展示的是这片区域的地图：
![p607_marsh.png](https://projecteuler.net/project/images/p607_marsh.png)
沼泽由5个不同的条状部分组成，每个部分宽10里格，在地图中表现为深浅的不同。最靠近A的条状部分沼泽化程度最浅，在这部分的行进速度可以达到每天9里格。然而，随着向东行进，每个条状部分逐渐难以前行，行进速度依次降低为每天8、7、6里格，直到最后一部分只有每天5里格；随后沼泽部分结束，回到正常的土地上，行进速度恢复到每天10里格。

如果弗罗多和山姆径直前往点B，他们恰好移动100里格，而这趟旅程将会花费约13.4738天。然而，如果他们不走直路，他们可以缩短旅行所需的时间。

找出从点A到点B所需的最少旅行时间，以天为单位，并保留小数点后10位小数。
608
## [#因数和](#因数和)**因数和**

记D(m,n)=∑d|m∑k=1nσ0(kd)，其中d取遍m的所有因数，而σ0(n)表示n的因数数目。
已知D(3!,102)=3398以及D(4!,106)=268882292。

求D(200!,1012) mod (109+7)。
609
## [#pi-序列](#pi-序列)**π序列**

对于任意n≥1，素数计数函数π(n)表示不超过n的素数数目。
例如，π(6)=3以及π(100)=25。

我们称序列u=(u0,⋯,um)为π序列，如果

- 对于任意n，un≥1
- un+1=π(un)
- u中包含至少两个元素

对于u0=10，有三个不同的π序列：(10,4)，(10,4,2)和(10,4,2,1)。

记c(u)为序列u中非素数元素的数目。
记p(n,k)为满足u0≤n和c(u)=k的π序列u的数目。
记P(n)为所有大于0的p(n,k)的乘积。
已知：P(10)=3×8×9×3=648以及P(100)=31038676032。

求P(108)，并将答案对1000000007取模。
610


## [#罗马数字II](#罗马数字II)**罗马数字II**

一个随机生成器从集合{I, V, X, L, C, D, M, #}中生成一个符号序列。序列中的每个符号都是独立于其它符号随机选出的，在每一步中，七个字母都以14%的等概率被选中，而#号则只有2%的概率被选中。

我们将生成的符号从左到右地写成序列，直到我们首次碰到#号出现（但并不写下）。此外，我们还要求写下的字母序列构成一个合法的最简形式罗马数字表示（除非是空序列）。如果写下下一个字母将会违反规则，我们就跳过它，并尝试下一个生成的符号。

请仔细阅读[关于罗马数字](https://projecteuler.net/about=roman_numerals)以了解本题中所提及的“合法罗马数字表示”和“最简形式”。例如，表示49的（唯一）合法序列是XLIX。减法组合IL是不合法的，因为它违反了规则(ii)，而XXXXIX是合法的但不是最简形式。规则中并未限制字母M的出现次数，所以所有整数都有一个合法的表示。这些规则同样被用在[第89题](/89/)中，欢迎各位先去解决那道更早的问题。

找出当我们停止时所表示的数的期望值。（当什么都没写下时视为0。）将答案四舍五入至小数点后8位。
